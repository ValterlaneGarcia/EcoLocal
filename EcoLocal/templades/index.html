<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/css/style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../static/script.js/db_buscaCep.js"></script>
    <title>EcoLocal</title>
</head>
<body>
    <nav class="navegacao">
        <h1>EcoLocal</h1>
    </nav>
    <main>
        <h2>"Juntos, Transformamos Nossa Comunidade!"</h2>
        <p>Relate problemas, conecte-se com voluntários e faça a diferença na sua região</p>
        <div id="buscador">
            <label for="buscador_cep"></label>
            <input id="buscar_cep" name="buscador_cep" type="search" placeholder="CEP">

            <a id="pesquisar" href="#">
                <button id="pesquisar_cep"><i class='bx bx-search'></i></button>
            </a>
        </div>
    </main>

    <footer></footer>

    <script>
        $('#pesquisar_cep').click(function(e) {
            e.preventDefault();

            if (validaCep()) {
            if ($('#loadingOverlay').length === 0) {
            $('main').append('<div id="loadingOverlay"><div class="loader">Carregando...</div></div>');
            }
                $('#loadingOverlay').fadeIn();

                setTimeout(function() {
                    $('#loadingOverlay').fadeOut(); 
                    var cep = $('#buscar_cep').val();
                        carregaTela(cep);
                }, 3000);
            } else {
                $('#buscar_cep').val('');
            }
        });

        function validaCep() {
            var cep = $('#buscar_cep').val();
            if (cep == '') {
                alert("É preciso de um CEP válido.");
                return false;
            }

            var regexCep = /^[0-9]{5}-?[0-9]{3}$/;
            if (!regexCep.test(cep)) {
                alert("É preciso de um CEP válido.");
                return false;
            }

            return true;
        }
    </script>
</body>
</html>
